View(corr)
corr=wb2%>%select(hhsize,landowned,landposs,landcult,numofmgnrega)%>%na.omit()
cor()%>%round(1)
corr=wb2%>%select(hhsize,landowned,landposs,landcult,numofmgnrega)%>%na.omit()%>%
cor()%>%round(1)
View(corr)
ggcorrplot(corr, hc.order = TRUE,
type = "lower",
lab = TRUE,
lab_size = 3,
method="circle",
colors = c("tomato2", "white", "springgreen3"),
title="Correlogram of Non-Category Variables",
ggtheme=theme_bw)
bcorr=wb2%>%select(hhsize,landowned,landposs,landcult)%>%na.omit()%>%
cor()%>%round(1)
ggbcorr=ggcorrplot(corr, hc.order = TRUE,
type = "lower",
lab = TRUE,
lab_size = 3,
method="circle",
colors = c("tomato2", "white", "springgreen3"),
title="Landownership~Household size",
ggtheme=theme_bw)
bcorr=wb2%>%select(hhsize,landowned,landposs,landcult)%>%na.omit()%>%
cor()%>%round(1)
ggcorrplot(corr, hc.order = TRUE,
type = "lower",
lab = TRUE,
lab_size = 3,
method="circle",
colors = c("tomato2", "white", "springgreen3"),
title="Landownership~Household size",
ggtheme=theme_bw)
corr=wb2%>%select(hhsize,landowned,landposs,landcult)%>%na.omit()%>%
cor()%>%round(1)
ggcorrplot(corr, hc.order = TRUE,
type = "lower",
lab = TRUE,
lab_size = 3,
method="circle",
colors = c("tomato2", "white", "springgreen3"),
title="Landownership~Household size",
ggtheme=theme_bw)
wb2%>%select(`social group`,occupation)%>%count(occupation)
wb2%>%select(`social group`,occupation)%>%count(occupation)%>%fct_lump(10)
wb2%>%select(`social group`,occupation)%>%fct_lump(occupation,10)
wb2%>%select(`social group`,occupation)%>%mutate(occupation=fct_lump(occupation,7)%>%count(occupation)
wb2%>%select(`social group`,occupation)%>%mutate(occupation=fct_lump(occupation,7))%>%count(occupation)%>%
wb2%>%select(`social group`,occupation)%>%mutate(occupation=fct_lump(occupation,7))%>%count(occupation)
wb2%>%select(`social group`,occupation)%>%mutate(occupation=fct_lump(occupation,10))%>%count(occupation)
wb2$occupation=fct_lump(wb2$occupation,10)
bcorr=wb2%>%select(`social group`,occupation)%>%spread(`social group`,occupation)
View(bcorr)
bcorr=wb2%>%spread(`social group`,occupation)
View(bcorr)
bcorr=wb2%>%spread(`social group`,occupation)%>%select(SC,ST,OBC,Others)
bcorr=wb2%>%spread(`social group`,occupation)%>%select(SC,ST,OBC,Others)%count(SC)
bcorr=wb2%>%spread(`social group`,occupation)%>%select(SC,ST,OBC,Others)%>%count(SC)
View(bcorr)
bcorr=wb2%>%spread(`social group`,occupation)%>%select(SC,ST,OBC,Others)%>%mutate(SC=count(SC),ST=count(ST))
bcorr=wb2%>%spread(`social group`,occupation)%>%select(SC,ST,OBC,Others)%>%count(SC,ST,OBC)
View(bcorr)
bcorr=wb2%>%spread(`social group`,occupation)%>%select(SC,ST,OBC,Others)%>%mutate(SC=n())
bcorr=wb2%>%spread(`social group`,occupation)%>%select(SC,ST,OBC,Others)%>%mutate(SC=count(SC))
bcorr=wb2%>%spread(`social group`,occupation)%>%select(SC,ST,OBC,Others)%>%count(SC)
View(bcorr)
bcorr=wb2%>%spread(`social group`,occupation)%>%select(SC,ST,OBC,Others)%>%count(SC)%>%rename(sc=n)
obc=wb2%>%spread(`social group`,occupation)%>%select(SC,ST,OBC,Others)%>%count(OBC)%>%rename(obc=n)
st=wb2%>%spread(`social group`,occupation)%>%select(SC,ST,OBC,Others)%>%count(ST)%>%rename(st=n)
others=wb2%>%spread(`social group`,occupation)%>%select(SC,ST,OBC,Others)%>%count(Others)%>%rename(others=n)
obc=wb2%>%spread(`social group`,occupation)%>%select(SC,ST,OBC,Others)%>%count(OBC)%>%rename(obc=n)%>%select(obc)
st=wb2%>%spread(`social group`,occupation)%>%select(SC,ST,OBC,Others)%>%count(ST)%>%rename(st=n)select(st)
st=wb2%>%spread(`social group`,occupation)%>%select(SC,ST,OBC,Others)%>%count(ST)%>%rename(st=n)%>%select(st)
others=wb2%>%spread(`social group`,occupation)%>%select(SC,ST,OBC,Others)%>%count(Others)%>%rename(others=n)%>%select(others)
sc=wb2%>%spread(`social group`,occupation)%>%select(SC,ST,OBC,Others)%>%count(SC)%>%rename(occupation=SC,sc=n)
View(sc)
Occ.count=cbind(sc,obc,st,others)
View(Occ.count)
wb2$occupation=fct_lump(wb2$occupation,10)
sc=wb2%>%spread(`social group`,occupation)%>%select(SC,ST,OBC,Others)%>%count(SC)%>%rename(occupation=SC,sc=n)
obc=wb2%>%spread(`social group`,occupation)%>%select(SC,ST,OBC,Others)%>%count(OBC)%>%rename(obc=n)%>%select(obc)
st=wb2%>%spread(`social group`,occupation)%>%select(SC,ST,OBC,Others)%>%count(ST)%>%rename(st=n)%>%select(st)
others=wb2%>%spread(`social group`,occupation)%>%select(SC,ST,OBC,Others)%>%count(Others)%>%rename(others=n)%>%select(others)
occ.count=cbind(sc,obc,st,others)
rm(Occ.count)
View(occ.count)
sum(occ.count$sc)
b=map(occ.count,~.x/sum(.x))
b=map(occ.count,function(x) (100*x/sum(x)) )
b=map(occ.count[-1],function(x) (100*x/sum(x)) )
View(b)
as.tibble(b)
b=as.tibble(b)
View(b)
b=round(b,1)
View(b)
b=paste0(round(b,1),"%")
b=map(occ.count[-1],function(x) (100*x/sum(x)) )
b=as.tibble(b)
b=paste0(round(b,1),"%")
b=map(occ.count[-1],function(x) (100*x/sum(x)) )
b=as.tibble(b)
paste0(round(b,1),"%")
map(b,function(x) paste0(round(x,1),"%"))
as.tibble(map(b,function(x) paste0(round(x,1),"%")))
b=as.tibble(map(occ.count[-1],function(x) paste0(round(100*x/sum(x),1),"%")))
View(b)
b$sc
occ.count$sc=b$sc
occ.count$st=b$st
occ.count$obc=b$obc
occ.count$others=b$others
wb2$occupation=fct_lump(wb2$occupation,10)
sc=wb2%>%spread(`social group`,occupation)%>%select(SC,ST,OBC,Others)%>%count(SC)%>%rename(occupation=SC,sc=n)
obc=wb2%>%spread(`social group`,occupation)%>%select(SC,ST,OBC,Others)%>%count(OBC)%>%rename(obc=n)%>%select(obc)
st=wb2%>%spread(`social group`,occupation)%>%select(SC,ST,OBC,Others)%>%count(ST)%>%rename(st=n)%>%select(st)
others=wb2%>%spread(`social group`,occupation)%>%select(SC,ST,OBC,Others)%>%count(Others)%>%rename(others=n)%>%select(others)
occ.count=cbind(sc,obc,st,others)
b=map(occ.count[-1],function(x) (100*x/sum(x)) )
b=as.tibble(map(occ.count[-1],function(x) paste0(round(100*x/sum(x),1),"%")))
occ.count$sc=b$sc
occ.count$st=b$st
occ.count$obc=b$obc
occ.count$others=b$others
occ.count
wb2$occupation=fct_lump(wb2$occupation,10)
sc=wb2%>%spread(`social group`,occupation)%>%select(SC,ST,OBC,Others)%>%count(SC)%>%rename(occupation=SC,sc=n)
obc=wb2%>%spread(`social group`,occupation)%>%select(SC,ST,OBC,Others)%>%count(OBC)%>%rename(obc=n)%>%select(obc)
st=wb2%>%spread(`social group`,occupation)%>%select(SC,ST,OBC,Others)%>%count(ST)%>%rename(st=n)%>%select(st)
others=wb2%>%spread(`social group`,occupation)%>%select(SC,ST,OBC,Others)%>%count(Others)%>%rename(others=n)%>%select(others)
occ.count=cbind(sc,obc,st,others)
b=map(occ.count[-1],function(x) (100*x/sum(x)) )
b=as.tibble(map(occ.count[-1],function(x) paste0(round(100*x/sum(x),1),"%")))
occ.count$sc=b$sc
occ.count$st=b$st
occ.count$obc=b$obc
occ.count$others=b$others
as.dataframe(occ.count)
wb2$occupation=fct_lump(wb2$occupation,10)
sc=wb2%>%spread(`social group`,occupation)%>%select(SC,ST,OBC,Others)%>%count(SC)%>%rename(occupation=SC,sc=n)
obc=wb2%>%spread(`social group`,occupation)%>%select(SC,ST,OBC,Others)%>%count(OBC)%>%rename(obc=n)%>%select(obc)
st=wb2%>%spread(`social group`,occupation)%>%select(SC,ST,OBC,Others)%>%count(ST)%>%rename(st=n)%>%select(st)
others=wb2%>%spread(`social group`,occupation)%>%select(SC,ST,OBC,Others)%>%count(Others)%>%rename(others=n)%>%select(others)
occ.count=cbind(sc,obc,st,others)
b=map(occ.count[-1],function(x) (100*x/sum(x)) )
b=as.tibble(map(occ.count[-1],function(x) paste0(round(100*x/sum(x),1),"%")))
occ.count$sc=b$sc
occ.count$st=b$st
occ.count$obc=b$obc
occ.count$others=b$others
as.data.frame(occ.count)
count(wb2$occupation,is.NA)
count(wb2,is.NA(occupation))
which(wb2$occupation==NA)
View(sc)
j=wb2%>%spread(`social group`,occupation)
View(j)
wb2$occupation=fct_lump(wb2$occupation,10)
sc=wb2%>%spread(`social group`,occupation)%>%select(SC,ST,OBC,Others)%>%count(SC)%>%rename(occupation=SC,sc=n)
obc=wb2%>%spread(`social group`,occupation)%>%select(SC,ST,OBC,Others)%>%count(OBC)%>%rename(obc=n)%>%select(obc)
st=wb2%>%spread(`social group`,occupation)%>%select(SC,ST,OBC,Others)%>%count(ST)%>%rename(st=n)%>%select(st)
others=wb2%>%spread(`social group`,occupation)%>%select(SC,ST,OBC,Others)%>%count(Others)%>%rename(others=n)%>%select(others)
occ.count=cbind(sc,obc,st,others)
wb2$occupation=fct_lump(wb2$occupation,10)
sc=wb2%>%spread(`social group`,occupation)%>%select(SC,ST,OBC,Others)%>%count(SC)%>%rename(occupation=SC,sc=n)
obc=wb2%>%spread(`social group`,occupation)%>%select(SC,ST,OBC,Others)%>%count(OBC)%>%rename(obc=n)%>%select(obc)
st=wb2%>%spread(`social group`,occupation)%>%select(SC,ST,OBC,Others)%>%count(ST)%>%rename(st=n)%>%select(st)
others=wb2%>%spread(`social group`,occupation)%>%select(SC,ST,OBC,Others)%>%count(Others)%>%rename(others=n)%>%select(others)
occ.count=cbind(sc,obc,st,others)
occ.count
View(wb2)
#save(ai.2,ai.3,wb2,wb3, file="C:/R/projectWB/wb.RData")
load("C:/R/projectWB/wb.RData")
View(wb2)
View(occ.count)
View(obc)
count(wb2,`social group`=="SC")
tally(wb2,`social group`=="SC")
tally(wb2,`social group`=="SC",occupation=="Business Professionals")
tally(wb2,`social group`=="SC",occupation=="Business Professionals")
View(wb2)
tally(wb2,`social group`=="SC"&&occupation=="Business Professionals")
filter(wb2,`social group`=="SC"&occupation=="Business Professionals")
tally(filter(wb2,`social group`=="SC"&occupation=="Business Professionals"))
tally(filter(wb2,`social group`=="Others"&occupation=="Business Professionals"))
tally(filter(wb2,`social group`=="ST"&occupation=="Business Professionals"))
tally(filter(wb2,`social group`=="OBC"&occupation=="Business Professionals"))
tally(filter(wb2,occupation=="Business Professionals"))
count(wb3,education)
wb3%>%filter(sex=="female"&age<=18&`marital status`!="nevermarried")
x=wb3%>%filter(sex=="female"&age<=18&`marital status`!="nevermarried")
View(x)
x=wb3%>%filter(sex=="female"&&age<=18&&`marital status`!="nevermarried")
x=wb3%>%filter(age<=18&&`marital status`!="nevermarried")
x=wb3%>%filter(sex=="female"&& age<=18)
x=wb3%>%filter(sex=="female"& age<=18)
x=wb3%>%filter(sex=="female" & age<18)
wb3$age=as.numeric(wb3$age)
save(ai.2,ai.3,wb2,wb3, file="C:/R/projectWB/wb.RData")
View(wb3)
x=wb3%>%filter(sex=="female" & age<18)
x=wb3%>%filter(sex=="female" & age<18 &`marital status`!="nevermarried")
ggplot(wb2,aes(x=`social group`,y=landowned)) +geom_boxplot(varwidth = TRUE,fill="plum")
ggplot(wb2,aes(x=`social group`,y=landowned*100)) +geom_boxplot(varwidth = TRUE,fill="plum")
ggplot(wb2,aes(x=`social group`,y=landowned)) +geom_boxplot(varwidth = TRUE,fill="plum")
fll=fct_lump(wb2$region,3)
ggplot(wb2,aes(x=`social group`,y=landowned)) +
geom_boxplot(varwidth = TRUE,fill=fll )+
coord_cartesian(ylim=c(0,3))+
theme(axis.text.x = element_text(angle=65, vjust=0.6))
fll=fct_lump(wb2$religion,3)
ggplot(wb2,aes(x=`social group`,y=landowned)) +
geom_boxplot(varwidth = TRUE,fill=fll)+
coord_cartesian(ylim=c(0,3))+
theme(axis.text.x = element_text(angle=65, vjust=0.6))
ggplot(wb2,aes(x=`social group`,y=landowned)) +
geom_boxplot(varwidth = TRUE,fill=`social group`)+
coord_cartesian(ylim=c(0,3))+
theme(axis.text.x = element_text(angle=65, vjust=0.6))
ggplot(wb2,aes(x=`social group`,y=landowned)) +
geom_boxplot(varwidth = TRUE,fill=wb2$`social group`)+
coord_cartesian(ylim=c(0,3))+
theme(axis.text.x = element_text(angle=65, vjust=0.6))
ggplot(wb2,aes(x=`social group`,y=landowned)) +
geom_boxplot(varwidth = TRUE,fill=`social group`)+
coord_cartesian(ylim=c(0,3))+
theme(axis.text.x = element_text(angle=65, vjust=0.6))
a=wb2$`social group`
ggplot(wb2,aes(x=`social group`,y=landowned)) +
geom_boxplot(varwidth = TRUE,fill=a)+
coord_cartesian(ylim=c(0,3))+
theme(axis.text.x = element_text(angle=65, vjust=0.6))
ggplot(wb2,aes(x=`social group`,y=landowned)) +
geom_boxplot(varwidth = TRUE,fill="plum")+
coord_cartesian(ylim=c(0,3))+
theme(axis.text.x = element_text(angle=65, vjust=0.6))
ggplot(wb2,aes(x=`social group`,y=landowned)) +
geom_boxplot(varwidth = TRUE,fill="plum")+
coord_cartesian(ylim=c(0,0.5))+
theme(axis.text.x = element_text(angle=65, vjust=0.6))
ggplot(wb2,aes(x=`social group`,y=landowned)) +
geom_boxplot(varwidth = TRUE,fill="plum")+
coord_cartesian(ylim=c(0,0.5))+
theme(axis.text.x = element_text(angle=65, vjust=0.6)) +facet_wrap(~fll)
ggplot(wb2,aes(x=`social group`,y=landowned)) +
geom_boxplot(varwidth = TRUE,fill="plum")+
coord_cartesian(ylim=c(0,0.5))+
theme(axis.text.x = element_text(angle=65, vjust=0.6)) +facet_wrap(~religion)
wb2$religion=fct_lump(wb2$religion,3)
ggplot(wb2,aes(x=`social group`,y=landowned)) +
geom_boxplot(varwidth = TRUE,fill="plum")+
coord_cartesian(ylim=c(0,0.5))+
theme(axis.text.x = element_text(angle=65, vjust=0.6)) +facet_wrap(~religion)
wb2$religion=fct_lump(wb2$religion,3)
ggplot(wb2,aes(x=`social group`,y=landowned)) +
geom_boxplot(varwidth = TRUE,fill="plum")+
coord_cartesian(ylim=c(0,0.5))+
theme(axis.text.x = element_text(angle=65, vjust=0.6)) +facet_wrap(~religion)
wb2$religion=fct_lump(wb2$religion,3)
ggplot(wb2,aes(x=`social group`,y=landowned)) +
geom_boxplot(varwidth = TRUE,fill="plum")+
coord_cartesian(ylim=c(0,0.5))+
theme(axis.text.x = element_text(angle=65, vjust=0.6)) +facet_wrap(~religion)
ggplot(wb2,aes(x=`social group`,y=landowned)) +
geom_boxplot(varwidth = TRUE,fill="plum")+
coord_cartesian(ylim=c(0,0.5))+
theme(axis.text.x = element_text(angle=65, vjust=0.6)) +facet_wrap(~religion)
wb2$religion=fct_lump(wb2$religion,3)
ggplot(wb2,aes(x=`social group`,y=landowned)) +
geom_boxplot(varwidth = TRUE,fill="plum")+
coord_cartesian(ylim=c(0,0.5))+
theme(axis.text.x = element_text(angle=65, vjust=0.6)) +facet_wrap(~religion)
wb2$religion=fct_lump(wb2$religion,3)
ggplot(wb2,aes(x=`social group`,y=landowned)) +
geom_boxplot(varwidth = TRUE,fill="plum")+
coord_cartesian(ylim=c(0,0.5))+
theme(axis.text.x = element_text(angle=65, vjust=0.6)) +facet_wrap(~religion)
wb2$religion=fct_lump(wb2$religion,3)
ggplot(wb2,aes(x=`social group`,y=landowned)) +
geom_boxplot(varwidth = TRUE,fill="plum")+
coord_cartesian(ylim=c(0,0.5))+
theme(axis.text.x = element_text(angle=65, vjust=0.6))+labs(title="Boxplot of Landownership") +facet_wrap(~religion)
brks <- seq(-13000, 13000, 5000000)
lbls = paste0(as.character(c(seq(15, 0, -5), seq(5, 15, 5))), "K")
# Plot
ggplot(wb3, aes(x = education, fill = Gender)) +   # Fill column
geom_bar(width = .6) +   # draw the bars
scale_y_continuous(breaks = brks,   # Breaks
labels = lbls) + # Labels
coord_flip()
brks <- seq(-15000, 15000, 5000)
lbls = paste0(as.character(c(seq(15, 0, -5), seq(5, 15, 5))), "K")
# Plot
ggplot(wb3, aes(x = education, fill = Gender)) +   # Fill column
geom_bar(width = .6) +   # draw the bars
scale_y_continuous(breaks = brks,   # Breaks
labels = lbls) + # Labels
coord_flip()
brks <- seq(-15000, 15000, 5000)
lbls = paste0(as.character(c(seq(15, 0, -5), seq(5, 15, 5))), "K")
# Plot
ggplot(wb3, aes(x = education, fill = sex)) +   # Fill column
geom_bar(width = .6) +   # draw the bars
scale_y_continuous(breaks = brks,   # Breaks
labels = lbls) + # Labels
coord_flip()
brks <- seq(-15000, 15000, 5000)
lbls = paste0(as.character(c(seq(15, 0, -5), seq(5, 15, 5))), "K")
# Plot
ggplot(wb3, aes(x = education, fill = sex)) +   # Fill column
geom_bar(stat="identity",width = .6) +   # draw the bars
scale_y_continuous(breaks = brks,labels = lbls) +
coord_flip()
educount=wb3%>%select(education,sex)%>%group_by(education,sex)%>%unique()%>%count()
View(educount)
educount=wb3%>%select(education,sex)%>%group_by(education,sex)%>%count()
View(educount)
brks =seq(-1500, 1500, 500)
lbls = paste0(as.character(c(seq(15, 0, -5), seq(5, 15, 5))), "00")
library(ggfortify)
brks =seq(-1500, 1500, 500)
lbls = paste0(as.character(c(seq(15, 0, -5), seq(5, 15, 5))), "00")
ggplot(educount, aes(x = education, fill = n)) +   # Fill column
geom_bar(stat="identity",width = .6) +   # draw the bars
scale_y_continuous(breaks = brks,labels = lbls) +
coord_flip() +  # Flip axes
labs(title="Education comparision by Gender") +
theme_tufte() +  # Tufte theme from ggfortify
theme(plot.title = element_text(hjust = .5),
axis.ticks = element_blank()) +   # Centre plot title
scale_fill_brewer(palette = "Dark2")
brks =seq(-1500, 1500, 500)
lbls = paste0(as.character(c(seq(15, 0, -5), seq(5, 15, 5))), "00")
ggplot(educount, aes(x = education, fill = n)) +   # Fill column
geom_bar(stat="identity",width = .6) +   # draw the bars
scale_y_continuous(breaks = brks,labels = lbls) +
coord_flip() +  # Flip axes
labs(title="Education comparision by Gender") +
theme_classic() +  # Tufte theme from ggfortify
theme(plot.title = element_text(hjust = .5),
axis.ticks = element_blank()) +   # Centre plot title
scale_fill_brewer(palette = "Dark2")  # Color palette
brks =seq(-1500, 1500, 500)
lbls = paste0(as.character(c(seq(15, 0, -5), seq(5, 15, 5))), "00")
ggplot(educount, aes(x = education,y=sex, fill = n)) +   # Fill column
geom_bar(stat="identity",width = .6) +   # draw the bars
scale_y_continuous(breaks = brks,labels = lbls) +
coord_flip() +  # Flip axes
labs(title="Education comparision by Gender") +
theme_classic() +  # Tufte theme from ggfortify
theme(plot.title = element_text(hjust = .5),
axis.ticks = element_blank()) +   # Centre plot title
scale_fill_brewer(palette = "Dark2")
brks =seq(-1500, 1500, 500)
lbls = paste0(as.character(c(seq(15, 0, -5), seq(5, 15, 5))), "00")
ggplot(educount, aes(x = education,y=sex, fill = n)) +   # Fill column
geom_bar(stat="identity",width = .6) +   # draw the bars
scale_y_discrete(breaks = brks,labels = lbls) +
coord_flip()
brks =seq(-1500, 1500, 500)
lbls = paste0(as.character(c(seq(15, 0, -5), seq(5, 15, 5))), "00")
ggplot(educount, aes(x = education,y=n, fill = sex)) +   # Fill column
geom_bar(stat="identity",width = .6) +   # draw the bars
scale_y_discrete(breaks = brks,labels = lbls) +
coord_flip()
brks =seq(-1500, 1500, 500)
lbls = paste0(as.character(c(seq(15, 0, -5), seq(5, 15, 5))), "00")
ggplot(educount, aes(x = education,y=n, fill = sex)) +   # Fill column
geom_bar(stat="identity",width = .6) +   # draw the bars
scale_y_discrete(breaks = brks,labels = lbls) +
coord_flip() +  # Flip axes
labs(title="Education comparision by Gender") +
theme_classic() +  # Tufte theme from ggfortify
theme(plot.title = element_text(hjust = .5),
axis.ticks = element_blank()) +   # Centre plot title
scale_fill_brewer(palette = "Dark2")
educount$education=fct_inorder(educount$education)
brks =seq(-1500, 1500, 500)
lbls = paste0(as.character(c(seq(15, 0, -5), seq(5, 15, 5))), "00")
ggplot(educount, aes(x = education,y=n, fill = sex)) +   # Fill column
geom_bar(stat="identity",width = .6) +   # draw the bars
scale_y_discrete(breaks = brks,labels = lbls) +
coord_flip() +  # Flip axes
labs(title="Education comparision by Gender") +
theme_classic() +  # Tufte theme from ggfortify
theme(plot.title = element_text(hjust = .5),
axis.ticks = element_blank()) +   # Centre plot title
scale_fill_brewer(palette = "Dark2")
educount$education=fct_inorder(educount$education,n)
educount$education=fct_reorder(educount$education,n)
brks =seq(-1500, 1500, 500)
lbls = paste0(as.character(c(seq(15, 0, -5), seq(5, 15, 5))), "00")
ggplot(educount, aes(x = fct_reorder(education,sex,n),y=n, fill = sex)) +   # Fill column
geom_bar(stat="identity",width = .6)
brks =seq(-1500, 1500, 500)
lbls = paste0(as.character(c(seq(15, 0, -5), seq(5, 15, 5))), "00")
ggplot(educount, aes(x = fct_reorder2(education,sex,n),y=n, fill = sex)) +   # Fill column
geom_bar(stat="identity",width = .6)
brks =seq(-1500, 1500, 500)
lbls = paste0(as.character(c(seq(15, 0, -5), seq(5, 15, 5))), "00")
ggplot(educount, aes(x = fct_reorder2(education,sex,n),y=n, fill = sex)) +   # Fill column
geom_bar(stat="identity",width = .6) +   # draw the bars
scale_y_discrete(breaks = brks,labels = lbls) +
coord_flip() +  # Flip axes
labs(title="Education comparision by Gender") +
theme_classic() +  # Tufte theme from ggfortify
theme(plot.title = element_text(hjust = .5),
axis.ticks = element_blank()) +   # Centre plot title
scale_fill_brewer(palette = "Dark2")
library(ggthemes)
library(ggthemes)
educount=wb3%>%select(education,sex)%>%group_by(education,sex)%>%count()
brks =seq(-1500, 1500, 500)
lbls = paste0(as.character(c(seq(15, 0, -5), seq(5, 15, 5))), "00")
ggplot(educount, aes(x = fct_reorder2(education,sex,n),y=n, fill = sex)) +   # Fill column
geom_bar(stat="identity",width = .6) +   # draw the bars
scale_y_discrete(breaks = brks,labels = lbls) +
coord_flip() +  # Flip axes
labs(title="Education comparision by Gender") +
theme_tufte() +  # Tufte theme from ggfortify
theme(plot.title = element_text(hjust = .5),
axis.ticks = element_blank()) +   # Centre plot title
scale_fill_brewer(palette = "Dark2")
library(ggthemes)
educount=wb3%>%select(education,sex)%>%na.omit()%>%group_by(education,sex)%>%count()
brks =seq(-1500, 1500, 500)
lbls = paste0(as.character(c(seq(15, 0, -5), seq(5, 15, 5))), "00")
ggplot(educount, aes(x = fct_reorder2(education,sex,n),y=n, fill = sex)) +   # Fill column
geom_bar(stat="identity",width = .6) +   # draw the bars
scale_y_continuous(breaks = brks,labels = lbls) +
coord_flip()
library(ggthemes)
educount=wb3%>%select(education,sex)%>%na.omit()%>%group_by(education,sex)%>%count()
brks =seq(-1500, 1500, 500)
lbls = paste0(as.character(c(seq(15, 0, -5), seq(5, 15, 5))), "00")
ggplot(educount, aes(x = fct_reorder2(education,sex,n),y=n, fill = sex)) +   # Fill column
geom_bar(stat="identity",width = .6) +   # draw the bars
scale_y_continuous(breaks = brks,labels = lbls) +
coord_flip() +  # Flip axes
labs(title="Education comparision by Gender") +
theme_tufte() +  # Tufte theme from ggfortify
theme(plot.title = element_text(hjust = .5),
axis.ticks = element_blank()) +   # Centre plot title
scale_fill_brewer(palette = "Dark2")
library(ggthemes)
educount=wb3%>%select(education,sex)%>%na.omit()%>%group_by(education,sex)%>%count()
brks =seq(-8000, 8000, 1000)
lbls = paste0(as.character(c(seq(8, 0, -1), seq(1, 8, 1))), "k")
ggplot(educount, aes(x = fct_reorder2(education,sex,n),y=n, fill = sex)) +   # Fill column
geom_bar(stat="identity",width = .6) +   # draw the bars
scale_y_continuous(breaks = brks,labels = lbls) +
coord_flip() +  # Flip axes
labs(title="Education comparision by Gender") +
theme_tufte() +  # Tufte theme from ggfortify
theme(plot.title = element_text(hjust = .5),
axis.ticks = element_blank()) +   # Centre plot title
scale_fill_brewer(palette = "Dark2")
library(ggthemes)
educount=wb3%>%select(education,sex)%>%na.omit()%>%group_by(education,sex)%>%count()
brks =seq(-8000, 8000, 1000)
lbls = paste0(as.character(c(seq(8, 0, -1), seq(1, 8, 1))), "k")
ggplot(educount, aes(x = fct_reorder2(education,sex,n),y=n, fill = sex)) +   # Fill column
geom_bar(stat="identity",width = .6) +   # draw the bars
scale_y_continuous(breaks = brks,labels = lbls) +
coord_flip() +  # Flip axes
labs(title="Education comparision by Gender") +
theme_tufte() +  # Tufte theme from ggfortify
theme(plot.title = element_text(hjust = .5),
axis.ticks = element_blank()) +   # Centre plot title
scale_fill_brewer(palette = "Dark2")
library(ggthemes)
educount=wb3%>%select(education,sex)%>%na.omit()%>%group_by(education,sex)%>%count()
brks =seq(-8000, 8000, 1000)
lbls = paste0(as.character(c(seq(8, 0, -1), seq(1, 8, 1))), "k")
ggplot(educount, aes(x = fct_reorder2(education,sex,n),y=n, fill = sex)) +   # Fill column
geom_bar(stat="identity",width = .6) +   # draw the bars
scale_y_continuous(breaks = brks,labels = lbls) +
coord_flip() +  # Flip axes
labs(title="Education comparision by Gender") +
theme_tufte() +  # Tufte theme from ggfortify
theme(plot.title = element_text(hjust = .5),
axis.ticks = element_blank()) +   # Centre plot title
scale_fill_brewer(palette = "Dark2")
library(ggthemes)
educount=wb3%>%select(education,sex)%>%na.omit()%>%group_by(education,sex)%>%count()
brks =seq(-8000, 8000, 1000)
lbls = paste0(as.character(c(seq(8, 0, -1), seq(1, 8, 1))), "k")
ggplot(educount, aes(x = fct_reorder2(education,sex,n),y=n, fill = sex)) +   # Fill column
geom_bar(stat="identity",width = .6) +   # draw the bars
scale_y_continuous(breaks = brks,labels = lbls) +
coord_flip() +  # Flip axes
labs(title="Education comparision by Gender",x="Total",y="Education Level") +
theme_tufte() +  # Tufte theme from ggfortify
theme(plot.title = element_text(hjust = .5),
axis.ticks = element_blank()) +   # Centre plot title
scale_fill_brewer(palette = "Dark2")
library(ggthemes)
educount=wb3%>%select(education,sex)%>%na.omit()%>%group_by(education,sex)%>%count()
brks =seq(-8000, 8000, 1000)
lbls = paste0(as.character(c(seq(8, 0, -1), seq(1, 8, 1))), "k")
ggplot(educount, aes(x = fct_reorder2(education,sex,n),y=n, fill = sex)) +   # Fill column
geom_bar(stat="identity",width = .6) +   # draw the bars
scale_y_continuous(breaks = brks,labels = lbls) +
coord_flip() +  # Flip axes
labs(title="Education comparision by Gender",y="Total",x="Education Level") +
theme_tufte() +  # Tufte theme from ggfortify
theme(plot.title = element_text(hjust = .5),
axis.ticks = element_blank()) +   # Centre plot title
scale_fill_brewer(palette = "Dark2")
View(wb2)
library(plotly)
